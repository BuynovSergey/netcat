!function(e){if(e){var n=5242880,a="FileReader"in window;e.fn.upload=function(){return this.each(function(){var n=e(this);if(!n.hasClass("nc-upload-applied")){n.addClass("nc-upload-applied");var a,d=t(n),m=n.find(".nc-upload-files"),g=m.find(".nc-upload-file");if(g.length>0&&!d&&n.find(".nc-upload-input").hide(),g.each(function(){var n=e(this),a=n.data("type"),i=n.find(".nc-upload-file-name");l(n,a,i.html(),i.data("preview-url")?i.data("preview-url"):i.prop("href"),!1)}),setTimeout(function(){s(n)},10),n.on("change",".nc-upload-input",function(){var n,a,l,t,p,s,v;d?(a=e(n=this),l=u(a),t=l.data("maxFiles"),p=l.data("fieldName"),s=function(e){return"multifile_"+e+"["+p+"][]"},v=o(n),a.hide().clone().val("").appendTo(l).show(),a.removeClass("nc-upload-input").appendTo(l.find(".nc-upload-new-files")),e.each(v,function(d){var o=function(e){var n=e.data("nextUploadIndex")||0;return e.data("nextUploadIndex",n+1),n}(l);1==v.length&&a.addClass("nc-upload-file-index--"+o);var u=i(n,d).hide().data("uploadIndex",o).append(f(s("id")),f(s("upload_index"),o),f(s("delete"),0).addClass("nc-upload-file-remove-hidden"));if(l.data("customName")){var p=l.data("customNameCaption"),m=r("text",s("name"),"",p);e('<div class="nc-upload-file-custom-name"/>').append(m).appendTo(u)}t&&"0"!=t&&c(l)>=t?h(u):u.slideDown(100)})):function(e){e.value&&i(e,0).hide().slideDown(100).find(".nc-upload-file-custom-name input:text").focus()}(this)}),m.find(".nc-upload-file-remove").attr("onclick",""),m.on("click",".nc-upload-file-remove",v),p(n).change(function(){i(this,0)}),d&&n.append(f("multifile_js["+n.data("fieldName")+"]",1)),d)m.on("mousedown",".nc-upload-file-drag-handle",function(n){n.preventDefault(),m.addClass("nc--dragging"),a=e(this).closest(".nc-upload-file").addClass("nc--dragged"),e(window).on("mouseup.nc-upload",function(){m.removeClass("nc--dragging"),a.removeClass("nc--dragged"),e(window).off("mouseup.nc-upload"),a=null})}),m.on("mousemove",".nc-upload-file",function(n){var i,l=e(this);if(a&&!l.hasClass("nc--dragged")){if("none"==l.css("float"))i=n.pageY-l.offset().top<l.height()/2;else i=n.pageX-l.offset().left<l.width()/2;i?a.insertBefore(l):a.insertAfter(l)}})}})},e(document).on("apply-upload",function(n){e(".nc-upload").upload()})}function i(i,t){var p;if("hidden"===i.type){var c=i.value,f=c.split("/").pop();p={name:f,type:f.split(".").pop(),url:c+"?"+Math.random().toString().substr(2),size:0}}else p=o(i)[t];var r=e('<div class="nc-upload-file"><div class="nc-upload-file-info"><span class="nc-upload-file-name">'+p.name+'</span> <a href="#" class="nc-upload-file-remove" tabindex="-1">Ã—</a></div></div>'),h=u(i),m=h.find(".nc-upload-files");if(r.appendTo(m),r.find(".nc-upload-file-remove").off("click.nc-upload").on("click.nc-upload",v),d(p.type)){if(p.url)l(r,p.type,p.name,p.url,!0);else if(a&&p.size<n){var g=new FileReader;g.onload=function(e){l(r,p.type,p.name,e.target.result,!0)},g.readAsDataURL(p)}}else l(r,p.type,p.name,null,!0);return s(h),r}function l(n,i,l,o,t){var p=e("<div/>").addClass("nc-upload-file-preview nc-upload-file-drag-handle"),c=o&&d(i);if(c&&a)p.addClass("nc-upload-file-preview-image").append('<img src="'+o+'" />'),u(n).addClass("nc-upload-with-preview");else{var s=l.lastIndexOf(".");p.addClass("nc-upload-file-preview-other"),s>0&&p.append('<span class="nc-upload-file-extension">'+l.substr(s+1)+"</span>")}return n.prepend('<div class="nc-upload-file-drag-icon nc-upload-file-drag-handle"><i class="nc-icon nc--file-text"></i></div>',p),(c||n.closest(".nc-upload-with-preview").length)&&a&&(t?p.slideDown(100):p.show()),p}function d(e){return/^(image\/)?(jpe?g|png|gif|bmp|webp|svg([+-]xml)?)$/i.test(e)}function o(e){return a?e.files:[{name:e.value.substr(e.value.lastIndexOf("\\")+1),type:"",size:0}]}function t(e){return e.hasClass("nc-upload-multifile")}function u(n){return e(n).closest(".nc-upload")}function p(e){return u(e).find(".nc-upload-file-server-path")}function c(n){return n.find(".nc-upload-file").filter(function(){return"none"!==e(this).css("display")}).length}function s(e){var n=t(e)?e.data("maxFiles"):1;if(n){var a=p(e),i=e.find(".nc-upload-input"),l=c(e)<n;a.length?(i.hide(),e.find(".nc-upload-hide-if-full").toggle(l)):i.toggle(l)}}function f(e,n){return r("hidden",e,n)}function r(n,a,i,l){return e("<input />",{type:n,name:a,value:void 0===i?"":i,placeholder:l||""})}function v(n){n.preventDefault();var a=e(n.target).closest(".nc-upload-file"),i=u(a),l=i.find(".nc-upload-input"),d=l;h(a),t(i)?i.find(".nc-upload-file-index--"+a.data("uploadIndex")).val(""):(d=l.clone().val(""),l.replaceWith(d),p(i).val("")),a.slideUp(100,function(){var n="nc-upload-with-preview";i.hasClass(n)&&0==i.find(".nc-upload-file:visible .nc-upload-file-preview-image").length&&i.removeClass(n);var a=e.Event("change");a.target=d[0],e(document).trigger(a),s(i)})}function h(e){e.find(".nc-upload-file-remove-hidden").val(1).trigger("change")}}(window.$nc||window.jQuery);
